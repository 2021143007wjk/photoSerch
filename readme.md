# 2025 우정광 바이브 코딩 프로젝트: 사진을 통한 신구대학교 캠퍼스 위치 탐색

## 1. 프로젝트 개요 (Project Overview)

### 1.1 프로젝트 배경 및 목적

본 프로젝트는 신구대학교 캠퍼스 공간을 대상으로 COLMAP 기반의 고정밀 3D 맵을 구축하고, StreetCLIP 딥러닝 모델을 활용하여 사용자가 촬영한 사진과 3D 맵을 매칭하는 시스템을 개발하는 것을 목표로 한다. 이를 통해 GPS 신호 수신이 불가능한 지하 공간이나 복잡한 실내에서도 사진 한 장으로 현재 위치를 정확히 파악할 수 있는 시각적 위치 추정(Visual Localization) 솔루션을 제공하고자 한다.

### 1.2 핵심 목표

| 목표 | 설명 |
|:----|:----|
| **3D 공간 데이터 구축** | 신구대학교 주요 구역의 영상 데이터를 수집하고, COLMAP을 활용하여 정밀한 3차원 포인트 클라우드(Point Cloud) 지도를 구축한다. |
| **시각적 위치 검색** | StreetCLIP 모델을 도입하여, 사용자가 촬영한 2D 쿼리 이미지를 3D 지도 상의 가장 유사한 위치와 매칭하는 AI 검색 엔진을 개발한다. |
| **사용자 친화적 시각화** | 추정된 위치를 학교 평면도 위에 직관적으로 표시하여 사용자가 자신의 위치를 쉽게 파악할 수 있도록 한다. |

위 세 가지를 목표로 삼아 사진 한 장으로 위치를 간단히 파악할 수 있도록 한다.

## 2. 기술 스택 및 시스템 아키텍처

본 프로젝트는 최신 컴퓨터 비전 기술과 딥러닝 모델을 결합한 하이브리드 아키텍처를 채택했습니다

### 2.1 3D 복원 (Structure from Motion)

COLMAP: 영상에서 추출한 수천 장의 프레임을 분석하여 카메라의 6자유도(6-DOF) 위치와 3차원 구조를 복원하는 핵심 엔진입니다.

기능: 특징점 추출(Feature Extraction), 매칭(Matching), 희소 복원(Sparse Reconstruction)을 수행하여 40개 이상의 세부 구역 맵을 생성했습니다.

### 2.2 이미지 검색 및 위치 추정 (Visual Place Recognition)

StreetCLIP (OpenAI CLIP 기반): 이미지의 시각적 특징과 지리적 컨텍스트를 동시에 이해하는 멀티모달 AI 모델입니다. 위치 인식에 특화된 파인튜닝 모델을 활용하여, 조명이나 날씨 변화에 강건한 검색 성능을 제공합니다.

Annoy (Approximate Nearest Neighbors): 고차원 벡터 공간에서 가장 유사한 이미지를 실시간으로 검색하기 위해 Spotify가 개발한 고속 인덱싱 라이브러리를 사용했습니다.

### 2.3 데이터 처리 및 시각화

OpenCV & Python: 동영상 프레임 추출, 이미지 전처리, 좌표 변환 행렬 계산 등 데이터 파이프라인 전반을 처리합니다.

Matplotlib & Folium: 사용자의 추정 위치를 2D 평면도 및 지도 위에 시각화하여 최종 결과를 제공합니다.

## 3. 개발 과정 및 방법론 (Implementation)

### 3.1 데이터 수집 및 전처리

수집 전략: 신구대학교 정문, 본관, 동관 등 주요 경로를 따라 24개의 고해상도 영상을 촬영했습니다. 특히 COLMAP의 복원율을 높이기 위해 천천히 걷기, 다양한 각도 촬영, 왕복 촬영(Loop Closure) 전략을 적용했습니다.

프레임 추출: 약 0.5초 간격으로 영상을 프레임화하여 총 10,000장 이상의 학습용 이미지 데이터셋을 구축했습니다.

### 3.2 3D 맵 구축 및 최적화

개별 복원 및 통합: 방대한 데이터를 효율적으로 처리하기 위해 영상을 24개 구역으로 나누어 개별적으로 3D 복원을 수행했습니다.

데이터 정제: 복원된 40개의 맵 조각 중 경로가 찌그러지거나 추적에 실패한 'B형 맵'을 선별하고, 경로가 완벽하게 복원된 'A형 맵(앵커 맵)' 3개를 기준점으로 선정하여 전체 지도의 정확도를 확보했습니다.

### 3.3 위치 추정 알고리즘 구현

특징 추출: 구축된 3D 맵의 모든 이미지에 대해 StreetCLIP을 사용하여 768차원 특징 벡터를 추출했습니다.

인덱싱: Annoy를 사용하여 벡터 데이터베이스를 구축, 밀리초(ms) 단위의 검색 속도를 구현했습니다.

좌표 변환 (Georeferencing): COLMAP의 상대 좌표계를 실제 학교 평면도 좌표계와 일치시키기 위해, 3점 매칭(3-Point Correspondences) 기반의 아핀 변환(Affine Transformation) 알고리즘을 적용했습니다.

## 4. 프로젝트 결과 및 성과 (Results)

정밀한 3D 지도 구축: 신구대학교 캠퍼스 주요 구역에 대한 고밀도 3D 포인트 클라우드 데이터를 성공적으로 생성했습니다.

강건한 위치 인식: 기존 GPS가 작동하지 않는 실내 및 건물 사이 공간에서도 이미지 한 장만으로 대략적인 위치를 파악하는 데 성공했습니다.

신뢰도 기반 시스템: 맵의 복원 품질에 따라 위치 추정 결과의 신뢰도(High/Low)를 사용자에게 함께 제공하여 시스템의 투명성을 높였습니다.

## 5. 결론 및 향후 과제 (Conclusion)

본 프로젝트는 별도의 비콘(Beacon)이나 하드웨어 설치 없이, 오직 영상 데이터와 AI 기술만으로 캠퍼스 내 위치 추정 시스템을 구현할 수 있음을 증명했습니다. 향후 과제로는 41개 조각 맵의 자동 통합 알고리즘 고도화와 모바일 앱으로의 서비스 확장을 제안합니다. 이 시스템은 신구대학교를 넘어, 대규모 쇼핑몰이나 공항 등 다양한 실내 공간의 스마트 네비게이션 솔루션으로 확장될 잠재력을 가지고 있습니다.
